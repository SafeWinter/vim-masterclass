# L34 Visual Mode - Part 1
---

本节演示文件：`vimclass/visual.txt`。



## 1 Vim 视觉模式的应用场景

`Vim` 的视觉模式与图形界面下的文本鼠标操作类似，甚至更强。常见的应用场景：

- 选中多行垂直文本块，并支持对多行内容进行批量处理；
- 在 `Vim` 指令生效前，方便查看 `Vim` 都选中了哪些内容；
- 启用视觉模式后，鼠标操作没有了，从而节约了大量键鼠切换时间。



## 2 Vim 的三种视觉模式

1. 字符级（characterwise）视觉模式：通过 `v` 开启；
2. 文本行（linewise）视觉模式：通过 `V` 开启；
3. 区块级（blockwise）视觉模式：通过 <kbd>Ctrl</kbd> + <kbd>V</kbd> 开启；

视觉模式的退出：任意位置按 <kbd>Escape</kbd> 键。



## 3 字符级视觉模式的基本操作

在视觉模式下，可以使用 `motion` 移动来选中某个区域，效果与 `Windows` 下 <kbd>Shift</kbd> + <kbd>方向键</kbd> 类似。但 `Windows` 仅支持单个字符的移动，最多配合 <kbd>Ctrl</kbd> 键实现基于单词的移动；而 `Vim` 中的所有 `motion` 移动都能用于定义某个选中区域。

**【示例一】视觉 + 方向键**

例如，将光标定位到字符 `t` 后，通过 <kbd>V</kbd> 键开启字符级视觉模式，再按 <kbd>L</kbd> 令光标右移：

![](../assets/34-1.png)

**图 34-1：按 v 开启字符级视觉模式后，右移光标后的实测效果**

**【示例二】视觉 + <kbd>W</kbd>**

接着按 <kbd>W</kbd> 键扫过单词 `start`：

![](../assets/34-2.png)

**图 34-2：继续按 w 扫过单词 start 的视觉效果**

选定文字区域后，可以执行相应的命令，例如 `d` 命令删除选中内容。

**【示例三】视觉 + 文本搜索**

从光标当前位置（`t` 字符处）选中下一个字符 `C` 之间的内容，输入 `/C` 即可：

![](../assets/34-3.png)

**图 34-3：字符级视觉模式下，输入 /C 可选中光标当前位置到下一处大写字符 C 之间的内容**



## 4 小写字母 o 的作用

默认情况下，开启视觉模式并选中某个区域后，当前光标会位于该区域的末尾。键入小写的 <kbd>O</kbd> 键后，光标会切换到该区域的起始位置，这样就能保留之前的内容，并沿反方向扩展该区域。

这里的 `o` 表示 **o**ther side of the region，即 **另一边**。再按一次 <kbd>O</kbd> 键，光标又重新回到另一边。

如果不切换光标位置直接反向移动，之前选中的区域将被抹除。



## 5 视觉模式 + 文本对象操作

<kbd>V</kbd><kbd>A</kbd><kbd>W</kbd>：可视化选中当前光标所在单词

<kbd>V</kbd><kbd>A</kbd><kbd>P</kbd>：可视化选中当前光标所在段落

> [!tip]
>
> **注意**
>
> 正常模式下的很多操作与视觉模式的顺序是反的：正常模式的 `yap` 对应视觉模式的 `vapy`。
>
> 正常模式先确定操作，再指定范围；视觉模式先确定范围，后追加操作。



## 6 文本行视觉模式的用法

在当前行的任意位置输入 <kbd>Shift</kbd><kbd>V</kbd> 将启用文本行视觉模式，并选中光标所在的一整行内容。

此时左右移动只会改变光标位置，当前行的选中区域一直不变；而上下移动则会将光标所在的行全部选中。

同理，使用小写字母 <kbd>O</kbd> 可以让光标从最后一行切换到首行，再按一次则还原。



## 7 快速选中上一次视觉模式选中的区域

使用 <kbd>G</kbd><kbd>V</kbd>



## 8 可在选中区域执行的常见操作

`~`： Switch case，切换大小写
`c`： Change，变更
`d`： Delete，删除
`y`： Yank，复制
`r`： Replace，替换
`x`： Delete，删除当前字符
`I`： Insert，从行首进入插入模式
`A`： Append，从行尾进入插入模式
`J`： Join，连接文本行
`u`： Make lowercase，转为小写
`U`： Make uppercase，转为大写
`>`： Shift right，向右缩进
`<`： Shift left，向左缩进



## 9 区块级视觉模式的用法示例

按 <kbd>Ctrl</kbd> + <kbd>V</kbd> 启用。

